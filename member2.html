import React, { useState } from 'react';

// --- TYPES ---
interface ModuleData {
  id: number;
  title: string;
  algoName: string;
  description: string;
  businessCase: string;
  graphModeling?: string;
  algoAnalysis: string;
  logicCode: string;
}

// --- VISUALIZATION COMPONENTS ---

const CommonDefs = () => (
  <defs>
    <filter id="glowCyan" x="-50%" y="-50%" width="200%" height="200%">
      <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
      <feMerge><feMergeNode in="coloredBlur"/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>
    <filter id="glowMagenta" x="-50%" y="-50%" width="200%" height="200%">
      <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
      <feMerge><feMergeNode in="coloredBlur"/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>
    <pattern id="smallGrid" width="20" height="20" patternUnits="userSpaceOnUse">
      <path d="M 20 0 L 0 0 0 20" fill="none" stroke="#222" strokeWidth="0.5"/>
    </pattern>
    <marker id="arrowHead" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto">
      <path d="M0,0 L0,6 L6,3 z" fill="#00f7ff" />
    </marker>
    <marker id="arrowHeadRed" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto">
      <path d="M0,0 L0,6 L6,3 z" fill="#ff2a6d" />
    </marker>
  </defs>
);

const LogisticViz = () => (
  <svg viewBox="0 0 400 320" className="w-full h-auto rounded-xl bg-[#0f0f1a] border border-[#333] shadow-2xl">
    <CommonDefs />
    {/* Radar Grid Background */}
    <rect width="400" height="320" fill="url(#smallGrid)" />
    <circle cx="200" cy="160" r="100" fill="none" stroke="#222" strokeWidth="1" strokeDasharray="5 5" />
    <circle cx="200" cy="160" r="150" fill="none" stroke="#222" strokeWidth="1" strokeDasharray="5 5" />

    {/* Drop-off Points */}
    <g id="locations">
        {/* Base */}
        <g transform="translate(200, 160)">
            <rect x="-6" y="-6" width="12" height="12" fill="#00f7ff" stroke="#fff" strokeWidth="1" />
            <text x="0" y="-10" fill="#00f7ff" fontFamily="monospace" fontSize="9" textAnchor="middle">BASE</text>
        </g>
        {/* Drops */}
        <circle cx="280" cy="100" r="4" fill="#111" stroke="#00ff9d" strokeWidth="2" />
        <circle cx="300" cy="220" r="4" fill="#111" stroke="#00ff9d" strokeWidth="2" />
        <circle cx="120" cy="240" r="4" fill="#111" stroke="#00ff9d" strokeWidth="2" />
        <circle cx="80" cy="120" r="4" fill="#111" stroke="#00ff9d" strokeWidth="2" />
    </g>

    {/* Optimized Flight Path (The Loop) */}
    <path id="flightPath" d="M 200 160 L 280 100 L 300 220 L 120 240 L 80 120 Z" 
          fill="none" stroke="#00f7ff" strokeWidth="2" filter="url(#glowCyan)" opacity="0.8">
          <animate attributeName="stroke-dasharray" values="0,1000;1000,0" dur="2s" fill="freeze" />
    </path>

    {/* The Drone */}
    <g>
        <circle r="3" fill="#fff" filter="url(#glowCyan)">
            <animateMotion dur="4s" repeatCount="indefinite" rotate="auto">
                <mpath href="#flightPath"/>
            </animateMotion>
        </circle>
        {/* Scanning Cone attached to drone */}
        <path d="M 0 0 L -10 20 L 10 20 Z" fill="rgba(0, 247, 255, 0.2)" stroke="none">
             <animateMotion dur="4s" repeatCount="indefinite" rotate="auto">
                <mpath href="#flightPath"/>
            </animateMotion>
        </path>
    </g>

    {/* HUD Elements */}
    <g transform="translate(20, 20)">
        <path d="M 0 0 L 20 0 L 25 10 L 100 10 L 105 0 L 120 0" fill="none" stroke="#00f7ff" strokeWidth="1" />
        <text x="0" y="25" fill="#aaa" fontFamily="monospace" fontSize="10">BATTERY:</text>
        <rect x="50" y="16" width="60" height="8" fill="#111" stroke="#333" />
        <rect x="52" y="18" width="40" height="4" fill="#00ff9d">
            <animate attributeName="width" values="56;40;30;20;10;56" dur="4s" repeatCount="indefinite" />
            <animate attributeName="fill" values="#00ff9d;#00ff9d;#ffff00;#ff0000;#00ff9d" dur="4s" repeatCount="indefinite" />
        </rect>
    </g>

    <g transform="translate(20, 280)">
        <text x="0" y="0" fill="#aaa" fontFamily="monospace" fontSize="10">STATUS:</text>
        <text x="50" y="0" fill="#00f7ff" fontFamily="Orbitron" fontSize="12">AUTOPILOT</text>
        <text x="0" y="15" fill="#aaa" fontFamily="monospace" fontSize="10">ETA:</text>
        <text x="50" y="15" fill="#fff" fontFamily="monospace" fontSize="10">14:02</text>
    </g>

    {/* Distance Markers */}
    <text x="240" y="120" fill="#555" fontFamily="monospace" fontSize="9">3.2km</text>
    <text x="310" y="160" fill="#555" fontFamily="monospace" fontSize="9">5.1km</text>
    <text x="210" y="250" fill="#555" fontFamily="monospace" fontSize="9">4.8km</text>
    <text x="80" y="190" fill="#555" fontFamily="monospace" fontSize="9">2.9km</text>
    <text x="140" y="130" fill="#555" fontFamily="monospace" fontSize="9">4.1km</text>
  </svg>
);

const BankViz = () => (
  <svg viewBox="0 0 400 320" className="w-full h-auto rounded-xl bg-[#0f0f1a] border border-[#333] shadow-2xl">
    <CommonDefs />
    <rect width="400" height="320" fill="url(#smallGrid)" />

    {/* Central Server */}
    <g transform="translate(200, 160)">
      <polygon points="0,-20 17,-10 17,10 0,20 -17,10 -17,-10" fill="#0d0d14" stroke="#ffae00" strokeWidth="2" filter="url(#glowCyan)" />
      <text x="0" y="4" fill="#ffae00" fontFamily="Orbitron" fontSize="8" textAnchor="middle">CORE</text>
      <circle r="30" fill="none" stroke="#ffae00" strokeWidth="0.5" opacity="0.5">
        <animate attributeName="r" values="30;40;30" dur="3s" repeatCount="indefinite" />
        <animate attributeName="opacity" values="0.5;0;0.5" dur="3s" repeatCount="indefinite" />
      </circle>
    </g>

    {/* Satellite Nodes */}
    {/* Node 1 */}
    <g transform="translate(100, 80)">
      <rect x="-10" y="-10" width="20" height="20" fill="#111" stroke="#00f7ff" strokeWidth="1" />
      <text x="0" y="25" fill="#aaa" fontFamily="monospace" fontSize="8" textAnchor="middle">ATM-01</text>
    </g>
    {/* Node 2 */}
    <g transform="translate(300, 80)">
      <rect x="-10" y="-10" width="20" height="20" fill="#111" stroke="#00f7ff" strokeWidth="1" />
      <text x="0" y="25" fill="#aaa" fontFamily="monospace" fontSize="8" textAnchor="middle">ATM-02</text>
    </g>
    {/* Node 3 */}
    <g transform="translate(100, 240)">
       <circle r="12" fill="#111" stroke="#ff2a6d" strokeWidth="1" />
       <text x="0" y="25" fill="#aaa" fontFamily="monospace" fontSize="8" textAnchor="middle">BR-West</text>
    </g>
    {/* Node 4 */}
    <g transform="translate(300, 240)">
       <circle r="12" fill="#111" stroke="#ff2a6d" strokeWidth="1" />
       <text x="0" y="25" fill="#aaa" fontFamily="monospace" fontSize="8" textAnchor="middle">BR-East</text>
    </g>

    {/* Connections */}
    <path id="link1" d="M 200 160 L 100 80" stroke="#333" strokeWidth="1" />
    <path id="link2" d="M 200 160 L 300 80" stroke="#333" strokeWidth="1" />
    <path id="link3" d="M 200 160 L 100 240" stroke="#333" strokeWidth="1" />
    <path id="link4" d="M 200 160 L 300 240" stroke="#333" strokeWidth="1" />

    {/* Data Packets */}
    <circle r="3" fill="#ffae00">
      <animateMotion dur="2s" repeatCount="indefinite" begin="0s">
        <mpath href="#link1"/>
      </animateMotion>
    </circle>
    <circle r="3" fill="#00f7ff">
      <animateMotion dur="2.5s" repeatCount="indefinite" begin="0.5s">
         <mpath href="#link2"/>
      </animateMotion>
    </circle>
    <circle r="3" fill="#ff2a6d">
      <animateMotion dur="3s" repeatCount="indefinite" begin="1s">
         <mpath href="#link3"/>
      </animateMotion>
    </circle>
    <circle r="3" fill="#fff">
      <animateMotion dur="1.5s" repeatCount="indefinite" begin="0.2s">
         <mpath href="#link4"/>
      </animateMotion>
    </circle>

    {/* Encrypted Lock Icon Overlay */}
    <g transform="translate(20, 20)">
         <text x="0" y="10" fill="#00f7ff" fontFamily="monospace" fontSize="10">ENCRYPTION: RSA-2048</text>
         <text x="0" y="25" fill="#00f7ff" fontFamily="monospace" fontSize="10">STATUS: SECURE</text>
    </g>
  </svg>
);

const WasteViz = () => (
  <svg viewBox="0 0 400 320" className="w-full h-auto rounded-xl bg-[#0f0f1a] border border-[#333] shadow-2xl">
    <CommonDefs />
    <rect width="400" height="320" fill="url(#smallGrid)" />

    {/* City Zones */}
    <rect x="50" y="50" width="300" height="220" fill="none" stroke="#222" strokeWidth="2" />

    {/* Bins */}
    <g id="bins">
      <circle cx="80" cy="80" r="5" fill="#333" stroke="#ffae00" strokeWidth="2" />
      <circle cx="320" cy="80" r="5" fill="#333" stroke="#ffae00" strokeWidth="2" />
      <circle cx="320" cy="240" r="5" fill="#333" stroke="#ffae00" strokeWidth="2" />
      <circle cx="80" cy="240" r="5" fill="#333" stroke="#ffae00" strokeWidth="2" />
      <circle cx="200" cy="160" r="5" fill="#333" stroke="#ffae00" strokeWidth="2" />
    </g>

    {/* TSP Route */}
    <path id="wasteRoute" d="M 200 290 L 80 240 L 80 80 L 200 160 L 320 80 L 320 240 L 200 290" 
          fill="none" stroke="#00f7ff" strokeWidth="2" strokeDasharray="5 5" opacity="0.6">
    </path>

    {/* Truck */}
    <g>
      <rect x="-8" y="-4" width="16" height="8" fill="#ff2a6d" filter="url(#glowMagenta)">
         <animateMotion dur="6s" repeatCount="indefinite" rotate="auto">
            <mpath href="#wasteRoute"/>
         </animateMotion>
      </rect>
    </g>

    {/* Depot */}
    <g transform="translate(200, 290)">
      <rect x="-15" y="-10" width="30" height="20" fill="#111" stroke="#fff" strokeWidth="1" />
      <text x="0" y="4" fill="#fff" fontFamily="monospace" fontSize="8" textAnchor="middle">DEPOT</text>
    </g>

    {/* Stats */}
    <g transform="translate(20, 20)">
       <text x="0" y="10" fill="#ffae00" fontFamily="Orbitron" fontSize="12">TSP OPTIMIZER</text>
       <text x="0" y="30" fill="#aaa" fontFamily="monospace" fontSize="10">ROUTE EFFICIENCY: 94%</text>
       <rect x="0" y="40" width="100" height="4" fill="#333" />
       <rect x="0" y="40" width="94" height="4" fill="#ffae00" />
    </g>
  </svg>
);

const EvacuationViz = () => (
  <svg viewBox="0 0 400 320" className="w-full h-auto rounded-xl bg-[#0f0f1a] border border-[#333] shadow-2xl">
    <CommonDefs />
    <rect width="400" height="320" fill="url(#smallGrid)" />

    {/* Danger Zone (Source) */}
    <g transform="translate(200, 160)">
      <circle r="20" fill="#ff2a6d" opacity="0.2">
        <animate attributeName="r" values="20;100;20" dur="2s" repeatCount="indefinite" />
        <animate attributeName="opacity" values="0.5;0;0.5" dur="2s" repeatCount="indefinite" />
      </circle>
      <circle r="10" fill="#ff2a6d" filter="url(#glowMagenta)" />
      <text x="0" y="4" fill="#fff" fontFamily="monospace" fontSize="10" fontWeight="bold" textAnchor="middle">!</text>
    </g>

    {/* Safe Zones */}
    <g transform="translate(30, 30)">
       <rect x="0" y="0" width="40" height="40" fill="none" stroke="#00ff9d" strokeWidth="2" strokeDasharray="4 2" />
       <text x="20" y="24" fill="#00ff9d" fontFamily="monospace" fontSize="10" textAnchor="middle">SAFE</text>
    </g>
    <g transform="translate(330, 30)">
       <rect x="0" y="0" width="40" height="40" fill="none" stroke="#00ff9d" strokeWidth="2" strokeDasharray="4 2" />
       <text x="20" y="24" fill="#00ff9d" fontFamily="monospace" fontSize="10" textAnchor="middle">SAFE</text>
    </g>
    <g transform="translate(330, 250)">
       <rect x="0" y="0" width="40" height="40" fill="none" stroke="#00ff9d" strokeWidth="2" strokeDasharray="4 2" />
       <text x="20" y="24" fill="#00ff9d" fontFamily="monospace" fontSize="10" textAnchor="middle">SAFE</text>
    </g>
    <g transform="translate(30, 250)">
       <rect x="0" y="0" width="40" height="40" fill="none" stroke="#00ff9d" strokeWidth="2" strokeDasharray="4 2" />
       <text x="20" y="24" fill="#00ff9d" fontFamily="monospace" fontSize="10" textAnchor="middle">SAFE</text>
    </g>

    {/* Evacuation Paths (BFS Tree style) */}
    <g stroke="#333" strokeWidth="1">
       {/* Top Left Path */}
       <path d="M 200 160 L 120 100 L 50 50" />
       <circle r="2" fill="#fff">
         <animateMotion dur="1s" repeatCount="indefinite" path="M 200 160 L 120 100 L 50 50" />
       </circle>

       {/* Top Right Path */}
       <path d="M 200 160 L 280 100 L 350 50" />
       <circle r="2" fill="#fff">
         <animateMotion dur="1.2s" repeatCount="indefinite" path="M 200 160 L 280 100 L 350 50" />
       </circle>

       {/* Bottom Right Path */}
       <path d="M 200 160 L 280 220 L 350 270" />
       <circle r="2" fill="#fff">
         <animateMotion dur="1.1s" repeatCount="indefinite" path="M 200 160 L 280 220 L 350 270" />
       </circle>

       {/* Bottom Left Path */}
       <path d="M 200 160 L 120 220 L 50 270" />
       <circle r="2" fill="#fff">
         <animateMotion dur="1.3s" repeatCount="indefinite" path="M 200 160 L 120 220 L 50 270" />
       </circle>
    </g>

    {/* Header */}
    <g transform="translate(130, 20)">
        <rect x="-10" y="0" width="140" height="20" fill="#111" stroke="#ff2a6d" />
        <text x="60" y="14" fill="#ff2a6d" fontFamily="Orbitron" fontSize="10" textAnchor="middle">ALERT: EVACUATE</text>
    </g>
  </svg>
);

const TaxViz = () => (
  <svg viewBox="0 0 400 320" className="w-full h-auto rounded-xl bg-[#0f0f1a] border border-[#333] shadow-2xl">
    <CommonDefs />
    <rect width="400" height="320" fill="url(#smallGrid)" />

    {/* Tree Connectors */}
    <g stroke="#333" strokeWidth="1.5">
       <line x1="200" y1="50" x2="100" y2="120" />
       <line x1="200" y1="50" x2="300" y2="120" />
       <line x1="100" y1="120" x2="50" y2="200" />
       <line x1="100" y1="120" x2="150" y2="200" />
       <line x1="300" y1="120" x2="250" y2="200" />
       <line x1="300" y1="120" x2="350" y2="200" />
    </g>

    {/* Nodes */}
    {/* Root */}
    <g transform="translate(200, 50)">
        <circle r="15" fill="#111" stroke="#00f7ff" strokeWidth="2" filter="url(#glowCyan)" />
        <text x="0" y="4" fill="#fff" fontFamily="monospace" fontSize="8" textAnchor="middle">1050</text>
    </g>

    {/* Level 2 */}
    <g transform="translate(100, 120)">
        <circle r="15" fill="#111" stroke="#00f7ff" strokeWidth="2" />
        <text x="0" y="4" fill="#fff" fontFamily="monospace" fontSize="8" textAnchor="middle">0520</text>
    </g>
    <g transform="translate(300, 120)">
        <circle r="15" fill="#111" stroke="#00f7ff" strokeWidth="2" />
        <text x="0" y="4" fill="#fff" fontFamily="monospace" fontSize="8" textAnchor="middle">1800</text>
    </g>

    {/* Level 3 */}
    <g transform="translate(50, 200)">
        <circle r="12" fill="#111" stroke="#aaa" strokeWidth="1" />
        <text x="0" y="4" fill="#aaa" fontFamily="monospace" fontSize="8" textAnchor="middle">0200</text>
    </g>
    <g transform="translate(150, 200)">
        <circle r="12" fill="#111" stroke="#aaa" strokeWidth="1" />
        <text x="0" y="4" fill="#aaa" fontFamily="monospace" fontSize="8" textAnchor="middle">0800</text>
    </g>
    <g transform="translate(250, 200)">
        <circle r="12" fill="#111" stroke="#aaa" strokeWidth="1" />
        <text x="0" y="4" fill="#aaa" fontFamily="monospace" fontSize="8" textAnchor="middle">1500</text>
    </g>
    <g transform="translate(350, 200)">
        <circle r="12" fill="#111" stroke="#aaa" strokeWidth="1" />
        <text x="0" y="4" fill="#aaa" fontFamily="monospace" fontSize="8" textAnchor="middle">2100</text>
    </g>

    {/* Scanning Bar */}
    <rect x="0" y="0" width="400" height="2" fill="#ffae00" opacity="0.5">
        <animate attributeName="y" values="0;320" dur="3s" repeatCount="indefinite" />
        <animate attributeName="opacity" values="0.5;0;0.5" dur="3s" repeatCount="indefinite" />
    </rect>

    {/* Balancing Indicator */}
    <g transform="translate(20, 280)">
       <text x="0" y="0" fill="#aaa" fontFamily="monospace" fontSize="10">TREE HEIGHT: 3</text>
       <text x="0" y="15" fill="#00f7ff" fontFamily="monospace" fontSize="10">BALANCE FACTOR: OK</text>
    </g>
  </svg>
);

// --- DATA CONSTANTS ---
const MODULES: ModuleData[] = [
  {
    id: 1,
    title: "Logistic Transport",
    algoName: "Dijkstra Algorithm",
    description: "Logistic transportation includes activities like last-mile delivery, warehousing, freight movement, and distribution planning.",
    businessCase: "In a city, logistics transportation includes activities like last-mile delivery, warehousing, freight movement, and distribution planning. Common modes are trucks, vans, two-wheelers, rail freight (where available), and increasingly electric vehicles. The main goals are to reduce traffic congestion, lower pollution, cut delivery time, and minimize costs.",
    graphModeling: "Nodes (Vertices): Warehouses, distribution centers, retail stores. | Edges: Roads/rail routes. | Weights: Distance, travel time, or cost.",
    algoAnalysis: "Dijkstra's Algorithm is widely used to find the shortest or least-cost path between a warehouse and delivery location in a transportation network, helping minimize travel time, distance, and fuel cost. It optimizes multi-stop delivery routes.",
    logicCode: `Input: n (number of locations), m (number of roads)
For each road: add edge (u, v, cost) to G
Input source (warehouse)
For i = 0 to n-1:
    dist[i] = ∞
    visited[i] = false
dist[source] = 0
Repeat n times:
    u = node with minimum dist[] and not visited
    visited[u] = true
For each neighbor v of u:
        if visited[v] == false AND
           dist[v] > dist[u] + cost(u, v):
               dist[v] = dist[u] + cost(u, v)
Output dist[]`
  },
  {
    id: 2,
    title: "Bank Management",
    algoName: "Dijkstra Algorithm",
    description: "Managing thousands of customer accounts and transactions securely requires instant access and verification.",
    businessCase: "Managing thousands of customer accounts and transactions securely requires instant access and verification to prevent fraud and delays in the financial district. Bank management in a city involves planning, organizing, and controlling banking operations to provide efficient financial services.",
    graphModeling: "Nodes: Bank branches, ATMs, Customers, Central Server. | Edges: Transaction Links, Cash transfer routes. | Weights: Transaction time, Cost, Network delay.",
    algoAnalysis: "Hashing allows O(1) access to account details. RSA Encryption ensures secure transactions. Time Complexity: O((V + E) log V). Space Complexity: O(V + E).",
    logicCode: `Input: n (number of branches/ATMs), m (number of links)
    add edge (u, v, time) to G
Input source (main branch)
For i = 0 to n-1:
    dist[i] = ∞
    visited[i] = false
dist[source] = 0
Repeat n times:
    u = unvisited node with minimum dist[u]
    visited[u] = true
For each adjacent node v of u:
        if visited[v] == false AND
           dist[v] > dist[u] + time(u, v):
               dist[v] = dist[u] + time(u, v)
Output dist[]`
  },
  {
    id: 3,
    title: "City Waste Management",
    algoName: "TSP / Heuristic",
    description: "Waste collection trucks must visit all locations once and return to the depot.",
    businessCase: "Waste collection trucks must visit all locations once and return to the depot. Exact TSP is NP-hard, so for large cities, heuristic or approximation algorithms are used: Nearest Neighbor, Genetic Algorithm, Ant Colony Optimization, or Simulated Annealing.",
    graphModeling: "Nodes: Bins, Depots. | Edges: Roads. | Weights: Distance/Time.",
    algoAnalysis: "Exact TSP: O(n!). Nearest Neighbor: O(n²). Space Complexity: O(n²) for adjacency matrix. Optimizes fuel and time for waste collection fleets.",
    logicCode: `Input: n (number of waste collection points)
       dist[n][n] (distance matrix)
visited[n] = false
route = empty list
start = 0 
current = start
visited[current] = true
For count = 1 to n-1:
    minDist = ∞
    nextNode = -1
    For i = 0 to n-1:
        if visited[i] == false AND dist[current][i] < minDist:
            minDist = dist[current][i]
            nextNode = i
    current = nextNode
    visited[current] = true
    add current to route
Output route`
  },
  {
    id: 4,
    title: "Disaster Evacuation",
    algoName: "BFS",
    description: "Safely move people from danger zones to the nearest safe shelters in minimum steps.",
    businessCase: "Safely move people from danger zones to the nearest safe shelters in minimum steps. Nodes: Affected areas, intersections, shelters. Edges: Roads.",
    graphModeling: "",
    algoAnalysis: "Breadth-First Search (BFS) is ideal for unweighted graphs (shortest path in terms of steps/hops). Time Complexity: O(V + E). Space Complexity: O(V) for the queue.",
    logicCode: `Input: V (number of locations), E (number of roads)
       Graph[V] (adjacency list), source (danger zone)
visited[V] = false
distance[V] = -1
visited[source] = true
distance[source] = 0
While Q is not empty:
    u = remove front element from Q
    For each v in Graph[u]:
        if visited[v] == false:
            visited[v] = true
            distance[v] = distance[u] + 1
            if v is a safe shelter:
                Output distance[v]   
                Stop
Output distance[]`
  },
  {
    id: 5,
    title: "City Tax Records",
    algoName: "AVL Tree",
    description: "City tax data must remain sorted for frequent updates and lookups.",
    businessCase: "City tax data must remain sorted (by property ID / taxpayer ID). Frequent updates (new taxpayers, deletions, corrections) require a balanced structure. AVL Tree remains height-balanced, guaranteeing O(log n) time.",
    graphModeling: "",
    algoAnalysis: "Search, Insert, Delete all take O(log n) due to self-balancing properties. Rotations (Left/Right) keep the tree balanced. Space Complexity: O(n).",
    logicCode: `Function Insert(node, key):
    if node == NULL: return node
    if key < node.key:
        node.left = Insert(node.left, key)
    else if key > node.key:
        node.right = Insert(node.right, key)
    else: return node 
    update node.height
    balance = BalanceFactor(node)
    if balance > 1 AND key < node.left.key:
        return RightRotate(node)
    if balance < -1 AND key > node.right.key:
        return LeftRotate(node)
    // ... complex rotation cases
    return node`
  }
];

// --- MAIN APPLICATION COMPONENT ---
const App: React.FC = () => {
  const [activeModule, setActiveModule] = useState<number>(1);

  const currentData = MODULES.find(m => m.id === activeModule) || MODULES[0];

  const renderVisualization = () => {
    switch(activeModule) {
      case 1: return <LogisticViz />;
      case 2: return <BankViz />;
      case 3: return <WasteViz />;
      case 4: return <EvacuationViz />;
      case 5: return <TaxViz />;
      default: return <LogisticViz />;
    }
  };

  return (
    <div className="container mx-auto px-6 py-10 max-w-7xl min-h-screen font-sans">
      <a href="#" className="inline-block mb-6 text-text-secondary hover:text-accent-main transition-colors duration-300">
        ← Back to Team Home
      </a>

      {/* HEADER */}
      <header className="flex flex-col md:flex-row justify-between items-start mb-16 p-8 rounded-3xl border-b border-[rgba(255,42,109,0.2)] hover:bg-gradient-to-r hover:from-white hover:to-accent-main group transition-all duration-500 hover:shadow-[0_10px_50px_rgba(255,42,109,0.4)] hover:scale-[1.02]">
        <div className="md:w-1/3">
          <h1 className="font-orbitron text-6xl tracking-wider bg-gradient-to-r from-white to-accent-main bg-clip-text text-transparent group-hover:text-bg-dark transition-all duration-300">
            Vikas
          </h1>
        </div>
        <div className="md:w-1/2 md:text-right mt-6 md:mt-0">
          <h2 className="font-orbitron text-accent-main text-2xl mb-4 group-hover:text-[#520015] transition-colors duration-300">
            Infrastructure Engineer
          </h2>
          <p className="text-text-secondary leading-relaxed group-hover:text-[#333] transition-colors duration-300">
            In accordance with our smart-city design architecture, I have engineered solutions to eliminate the core urban challenges. The following section highlights the technical insights, logic structures, and algorithmic models powering this transformation.
          </p>
        </div>
      </header>

      {/* MAIN SPLIT LAYOUT */}
      <div className="grid grid-cols-1 lg:grid-cols-[300px_1fr] gap-10 items-start">
        
        {/* NAVIGATION PANEL */}
        <div className="flex flex-col gap-4 overflow-x-auto lg:overflow-visible pb-4 lg:pb-0">
          {MODULES.map((module) => (
            <div 
              key={module.id}
              onClick={() => setActiveModule(module.id)}
              className={`
                p-5 rounded-xl border border-white/5 cursor-pointer transition-all duration-300 flex items-center justify-between group min-w-[240px]
                ${activeModule === module.id 
                  ? 'bg-[#ff2a6d]/15 border-accent-main shadow-[0_0_15px_rgba(255,42,109,0.2)] scale-100' 
                  : 'bg-bg-panel hover:bg-gradient-to-r hover:from-white hover:to-accent-main hover:border-transparent hover:shadow-[0_10px_30px_rgba(255,42,109,0.3)] hover:scale-105 hover:translate-x-2'
                }
              `}
            >
              <div>
                <div className={`font-semibold text-lg transition-colors duration-300 ${activeModule === module.id ? 'text-white' : 'text-white group-hover:text-bg-dark'}`}>
                  {module.title}
                </div>
                <div className={`text-sm font-mono transition-colors duration-300 ${activeModule === module.id ? 'text-accent-main' : 'text-accent-main group-hover:text-[#520015] group-hover:font-bold'}`}>
                  {module.algoName}
                </div>
              </div>
              <div className={`text-xl transition-colors duration-300 ${activeModule === module.id ? 'text-accent-main' : 'text-accent-main group-hover:text-[#333]'}`}>
                →
              </div>
            </div>
          ))}
        </div>

        {/* CONTENT DISPLAY PANEL */}
        <div className="bg-bg-panel rounded-3xl border border-white/5 p-8 lg:p-10 backdrop-blur-md min-h-[500px] relative overflow-hidden">
            <div key={activeModule} className="animate-fade-in">
              {/* BLOCK HEADER */}
              <div className="flex flex-col md:flex-row justify-between items-start md:items-center mb-8 bg-black/30 p-6 rounded-2xl border border-accent-main/30 shadow-[0_0_15px_rgba(255,42,109,0.05)]">
                <h3 className="font-orbitron text-3xl text-white mb-3 md:mb-0">
                  {currentData.title}
                </h3>
                <span className="bg-accent-sec text-bg-dark px-4 py-1.5 rounded-full font-bold text-sm">
                  {currentData.algoName}
                </span>
              </div>

              {/* GRID */}
              <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
                {/* LEFT TEXT CONTENT */}
                <div className="text-content">
                  <span className="block text-accent-main font-mono text-sm uppercase mb-3 mt-4">The Business Case</span>
                  <p className="text-text-secondary leading-relaxed mb-6">
                    {currentData.businessCase}
                  </p>

                  {currentData.graphModeling && (
                    <>
                      <span className="block text-accent-main font-mono text-sm uppercase mb-3">Graph Modeling</span>
                      <p className="text-text-secondary leading-relaxed mb-6 font-light">
                        {currentData.graphModeling}
                      </p>
                    </>
                  )}

                  <span className="block text-accent-main font-mono text-sm uppercase mb-3">Algorithm Analysis</span>
                  <p className="text-text-secondary leading-relaxed mb-6">
                    {currentData.algoAnalysis}
                  </p>

                  <span className="block text-accent-main font-mono text-sm uppercase mb-3">Implementation Logic</span>
                  <div className="bg-[#0d0d14] p-5 rounded-lg border-l-4 border-accent-main font-mono text-sm text-text-secondary whitespace-pre-wrap overflow-x-auto custom-scrollbar shadow-inner">
                    {currentData.logicCode}
                  </div>
                </div>

                {/* RIGHT VISUAL CONTENT */}
                <div className="visual-content">
                  <span className="block text-accent-main font-mono text-sm uppercase mb-3 lg:mt-4">Blueprint Analysis</span>
                  <div className="hover:scale-[1.02] transition-transform duration-500">
                    {renderVisualization()}
                  </div>
                </div>
              </div>
            </div>
        </div>

      </div>
    </div>
  );
};
